name: Checkout
on: [push]

jobs:
 
  checkout-and-display-files:
    permissions: 
      contents: write
      pull-requests: write
      repository-projects: write
    runs-on: ubuntu-latest
    steps:
      - uses : actions/checkout@v4
        with :
          fetch-depth: 0
          
      - name: repodescription
        shell: bash
        run: |
          gh repo view --json description | grep -oP '(?<="description":")[^"]*' | grep -oP '[a-zA-Z0-9 ]+' | tee -a log.txt
          echo "repo-description=$(cat log.txt)" 
        env:
         GH_TOKEN: ${{ github.token }} 

      - name: Get registration token
        id: getRegToken
        run: |
          curl -X POST -H \"Accept: application/vnd.github.v3+json\"  -H 'Authorization: token ${{ secrets.GITHUB_TOKEN }}' https://api.github.com/repos/myprofile/myrepo/actions/runners/registration-token
    
      - name: Authenticate repo
        run: |
          gh repo edit --description "testing"
        env:
          GH_TOKEN: ${{ github.token }}